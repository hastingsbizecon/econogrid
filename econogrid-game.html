<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EconoGrid</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* Light blue-gray background */
            color: #334155; /* Darker text */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff;
            border-radius: 1.5rem; /* More rounded corners */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1); /* Stronger shadow */
            padding: 2rem;
            max-width: 960px; /* Slightly wider */
            width: 100%;
            text-align: center;
        }
        .grid-container {
            display: grid;
            grid-template-columns: 1fr repeat(3, minmax(80px, 1fr)); /* Adjusted column sizing */
            grid-template-rows: 1fr repeat(3, minmax(80px, 1fr)); /* Adjusted row sizing */
            gap: 0.5rem;
            margin-top: 1.5rem;
        }
        .grid-cell, .grid-header {
            background-color: #e2e8f0; /* Lighter cell background */
            border-radius: 0.75rem; /* Rounded corners for cells */
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0.5rem;
            box-sizing: border-box;
            position: relative; /* For flag/cross positioning */
            overflow: hidden; /* Hide overflow for flag/cross */
        }
        /* Updated grid-cell for vertical stacking */
        .grid-cell {
            flex-direction: column; /* Stack children vertically */
            min-height: 100px; /* Increased min-height to accommodate stacked elements */
        }
        .grid-header {
            background-color: #cbd5e1; /* Slightly darker header background */
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: background-color 0.3s ease;
        }
        .grid-header:hover {
            background-color: #94a3b8; /* Darker on hover */
        }
        .grid-cell input {
            width: 100%;
            padding: 0.5rem;
            border: 2px solid #94a3b8; /* Tailwind gray-400 */
            border-radius: 0.5rem;
            text-align: center;
            font-size: 0.9rem;
            color: #1e293b; /* Dark slate */
            background-color: #f8fafc; /* Lighter input background */
            outline: none;
            transition: border-color 0.3s ease;
            margin-bottom: 0.5rem; /* Space between input and icon/flag */
        }
        .grid-cell input:focus {
            border-color: #3b82f6; /* Tailwind blue-500 */
        }
        /* Updated result-icon and flag styles for natural flow */
        .grid-cell .result-icon {
            position: static; /* Let them flow naturally */
            font-size: 2rem; /* Slightly smaller for better fit */
            margin-top: 0.5rem; /* Space from the input */
        }
        .grid-cell .result-icon.correct {
            color: #22c55e; /* Green for correct */
        }
        .grid-cell .result-icon.incorrect {
            color: #ef4444; /* Red for incorrect */
        }
        .grid-cell img.flag {
            position: static; /* Let them flow naturally */
            width: 48px; /* Smaller flag size */
            height: 48px;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-top: 0.5rem; /* Space from the input */
        }
        /* No difficulty buttons style needed */

        /* Auto-suggestion styles */
        .autocomplete-container {
            position: relative;
            width: 100%;
        }
        .autocomplete-list {
            position: absolute;
            top: 100%; /* Position below the input */
            left: 0;
            right: 0;
            background-color: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            max-height: 200px;
            overflow-y: auto;
            z-index: 100; /* Ensure it's on top */
            text-align: left;
        }
        .autocomplete-item {
            padding: 0.75rem 1rem;
            cursor: pointer;
            transition: background-color 0.2s ease;
            color: #334155;
        }
        .autocomplete-item:hover {
            background-color: #e2e8f0;
        }
        .title-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem; /* Space between logo and title */
            margin-bottom: 1.5rem;
        }
        .title-container svg {
            width: 2.5rem; /* Size of the SVG logo */
            height: 2.5rem;
            color: #3b82f6; /* Blue color for the logo */
        }

        /* Modal styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: #ffffff;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            max-width: 500px;
            width: 90%;
            text-align: left;
            position: relative;
        }
        .modal-close-button {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #64748b;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen bg-gray-100 p-4">
    <div class="container">
        <div class="title-container">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                <path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd" />
            </svg>
            <h1 class="text-4xl font-extrabold text-gray-800">EconoGrid</h1>
        </div>
        <p class="text-gray-600 mb-4">Guess the country for each economic characteristic intersection.</p>

        <div class="game-info flex justify-between items-center mb-6 text-lg font-semibold text-gray-700">
            <div id="guessesLeft" class="bg-blue-100 text-blue-800 px-4 py-2 rounded-full shadow-md">Guesses: 12</div>
            <div id="correctGuesses" class="bg-green-100 text-green-800 px-4 py-2 rounded-full shadow-md">Correct: 0/9</div>
        </div>

        <div class="grid-container" id="gameGrid">
            <div class="grid-cell bg-transparent shadow-none"></div>
            <div class="grid-header col-header" data-col="0"></div>
            <div class="grid-header col-header" data-col="1"></div>
            <div class="grid-header col-header" data-col="2"></div>
            <div class="grid-header row-header" data-row="0"></div>
            <div class="grid-cell" data-row="0" data-col="0"></div>
            <div class="grid-cell" data-row="0" data-col="1"></div>
            <div class="grid-cell" data-row="0" data-col="2"></div>

            <div class="grid-header row-header" data-row="1"></div>
            <div class="grid-cell" data-row="1" data-col="0"></div>
            <div class="grid-cell" data-row="1" data-col="1"></div>
            <div class="grid-cell" data-row="1" data-col="2"></div>

            <div class="grid-header row-header" data-row="2"></div>
            <div class="grid-cell" data-row="2" data-col="0"></div>
            <div class="grid-cell" data-row="2" data-col="1"></div>
            <div class="grid-cell" data-row="2" data-col="2"></div>
        </div>

        <div id="gameMessage" class="mt-6 text-xl font-bold text-red-600"></div>
    </div>

    <div id="definitionModal" class="modal-overlay hidden">
        <div class="modal-content">
            <button class="modal-close-button" onclick="document.getElementById('definitionModal').classList.add('hidden')">&times;</button>
            <h3 id="modalCategoryTitle" class="text-2xl font-bold mb-4 text-gray-800"></h3>
            <p id="modalCategoryDefinition" class="text-gray-700"></p>
        </div>
    </div>

    <div id="gameOverModal" class="modal-overlay hidden">
        <div class="modal-content text-center">
            <h3 id="gameOverTitle" class="text-3xl font-bold mb-4 text-gray-800"></h3>
            <p id="gameOverMessage" class="text-xl text-gray-700 mb-6"></p>
            <button class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-6 rounded-xl transition duration-300" onclick="location.reload()">Play Again</button>
        </div>
    </div>

    <script>
        // --- Data Definitions ---
        // Full list of countries for auto-suggestion. Includes ISO 2-letter codes for flag API.
        const allCountries = [
            { name: "Afghanistan", code: "AF" }, { name: "Albania", code: "AL" }, { name: "Algeria", code: "DZ" },
            { name: "Andorra", code: "AD" }, { name: "Angola", code: "AO" }, { name: "Antigua and Barbuda", code: "AG" },
            { name: "Argentina", code: "AR" }, { name: "Armenia", code: "AM" }, { name: "Australia", code: "AU" },
            { name: "Austria", code: "AT" }, { name: "Azerbaijan", code: "AZ" }, { name: "Bahamas", code: "BS" },
            { name: "Bahrain", code: "BH" }, { name: "Bangladesh", code: "BD" }, { name: "Barbados", code: "BB" },
            { name: "Belarus", code: "BY" }, { name: "Belgium", code: "BE" }, { name: "Belize", code: "BZ" },
            { name: "Benin", code: "BJ" }, { name: "Bhutan", code: "BT" }, { name: "Bolivia", code: "BO" },
            { name: "Bosnia and Herzegovina", code: "BA" }, { name: "Botswana", code: "BW" }, { name: "Brazil", code: "BR" },
            { name: "Brunei", code: "BN" }, { name: "Bulgaria", code: "BG" }, { name: "Burkina Faso", code: "BF" },
            { name: "Burundi", code: "BI" }, { name: "Cabo Verde", code: "CV" }, { name: "Cambodia", code: "KH" },
            { name: "Cameroon", code: "CM" }, { name: "Canada", code: "CA" }, { name: "Central African Republic", code: "CF" },
            { name: "Chad", code: "TD" }, { name: "Chile", code: "CL" }, { name: "China", code: "CN" },
            { name: "Colombia", code: "CO" }, { name: "Comoros", code: "KM" }, { name: "Congo (Dem. Rep.)", code: "CD" },
            { name: "Congo (Rep.)", code: "CG" }, { name: "Costa Rica", code: "CR" }, { name: "Croatia", code: "HR" },
            { name: "Cuba", code: "CU" }, { name: "Cyprus", code: "CY" }, { name: "Czechia", code: "CZ" },
            { name: "Denmark", code: "DK" }, { name: "Djibouti", code: "DJ" }, { name: "Dominica", code: "DM" },
            { name: "Dominican Republic", code: "DO" }, { name: "Ecuador", code: "EC" }, { name: "Egypt", code: "EG" },
            { name: "El Salvador", code: "SV" }, { name: "Equatorial Guinea", code: "GQ" }, { name: "Eritrea", code: "ER" },
            { name: "Estonia", code: "EE" }, { name: "Eswatini", code: "SZ" }, { name: "Ethiopia", code: "ET" },
            { name: "Fiji", code: "FJ" }, { name: "Finland", code: "FI" }, { name: "France", code: "FR" },
            { name: "Gabon", code: "GA" }, { name: "Gambia", code: "GM" }, { name: "Georgia", code: "GE" },
            { name: "Germany", code: "DE" }, { name: "Ghana", code: "GH" }, { name: "Greece", code: "GR" },
            { name: "Grenada", code: "GD" }, { name: "Guatemala", code: "GT" }, { name: "Guinea", code: "GN" },
            { name: "Guinea-Bissau", code: "GW" }, { name: "Guyana", code: "GY" }, { name: "Haiti", code: "HT" },
            { name: "Honduras", code: "HN" }, { name: "Hungary", code: "HU" }, { name: "Iceland", code: "IS" },
            { name: "India", code: "IN" }, { name: "Indonesia", code: "ID" }, { name: "Iran", code: "IR" },
            { name: "Iraq", code: "IQ" }, { name: "Ireland", code: "IE" }, { name: "Israel", code: "IL" },
            { name: "Italy", code: "IT" }, { name: "Jamaica", code: "JM" }, { name: "Japan", code: "JP" },
            { name: "Jordan", code: "JO" }, { name: "Kazakhstan", code: "KZ" }, { name: "Kenya", code: "KE" },
            { name: "Kiribati", code: "KI" }, { name: "Kuwait", code: "KW" }, { name: "Kyrgyzstan", code: "KG" },
            { name: "Laos", code: "LA" }, { name: "Latvia", code: "LV" }, { name: "Lebanon", code: "LB" },
            { name: "Lesotho", code: "LS" }, { name: "Liberia", code: "LR" }, { name: "Libya", code: "LY" },
            { name: "Liechtenstein", code: "LI" }, { name: "Lithuania", code: "LT" }, { name: "Luxembourg", code: "LU" },
            { name: "Madagascar", code: "MG" }, { name: "Malawi", code: "MW" }, { name: "Malaysia", code: "MY" },
            { name: "Maldives", code: "MV" }, { name: "Mali", code: "ML" }, { name: "Malta", code: "MT" },
            { name: "Marshall Islands", code: "MH" }, { name: "Mauritania", code: "MR" }, { name: "Mauritius", code: "MU" },
            { name: "Mexico", code: "MX" }, { name: "Micronesia", code: "FM" }, { name: "Moldova", code: "MD" },
            { name: "Monaco", code: "MC" }, { name: "Mongolia", code: "MN" }, { name: "Montenegro", code: "ME" },
            { name: "Morocco", code: "MA" }, { name: "Mozambique", code: "MZ" }, { name: "Myanmar", code: "MM" },
            { name: "Namibia", code: "NA" }, { name: "Nauru", code: "NR" }, { name: "Nepal", code: "NP" },
            { name: "Netherlands", code: "NL" }, { name: "New Zealand", code: "NZ" }, { name: "Nicaragua", code: "NI" },
            { name: "Niger", code: "NE" }, { name: "Nigeria", code: "NG" }, { name: "North Korea", code: "KP" },
            { name: "North Macedonia", code: "MK" }, { name: "Norway", code: "NO" }, { name: "Oman", code: "OM" },
            { name: "Pakistan", code: "PK" }, { name: "Palau", code: "PW" }, { name: "Palestine", code: "PS" },
            { name: "Panama", code: "PA" }, { name: "Papua New Guinea", code: "PG" }, { name: "Paraguay", code: "PY" },
            { name: "Peru", code: "PE" }, { name: "Philippines", code: "PH" }, { name: "Poland", code: "PL" },
            { name: "Portugal", code: "PT" }, { name: "Qatar", code: "QA" }, { name: "Romania", code: "RO" },
            { name: "Russia", code: "RU" }, { name: "Rwanda", code: "RW" }, { name: "Saint Kitts and Nevis", code: "KN" },
            { name: "Saint Lucia", code: "LC" }, { name: "Saint Vincent and the Grenadines", code: "VC" }, { name: "Samoa", code: "WS" },
            { name: "San Marino", code: "SM" }, { name: "Sao Tome and Principe", code: "ST" }, { name: "Saudi Arabia", code: "SA" },
            { name: "Senegal", code: "SN" }, { name: "Serbia", code: "RS" }, { name: "Seychelles", code: "SC" },
            { name: "Sierra Leone", code: "SL" }, { name: "Singapore", code: "SG" }, { name: "Slovakia", code: "SK" },
            { name: "Slovenia", code: "SI" }, { name: "Solomon Islands", code: "SB" }, { name: "Somalia", code: "SO" },
            { name: "South Africa", code: "ZA" }, { name: "South Korea", code: "KR" }, { name: "South Sudan", code: "SS" },
            { name: "Spain", code: "ES" }, { name: "Sri Lanka", code: "LK" }, { name: "Sudan", code: "SD" },
            { name: "Suriname", code: "SR" }, { name: "Sweden", code: "SE" }, { name: "Switzerland", code: "CH" },
            { name: "Syria", code: "SY" }, { name: "Taiwan", code: "TW" }, { name: "Tajikistan", code: "TJ" },
            { name: "Tanzania", code: "TZ" }, { name: "Thailand", code: "TH" }, { name: "Timor-Leste", code: "TL" },
            { name: "Togo", code: "TG" }, { name: "Tonga", code: "TO" }, { name: "Trinidad and Tobago", code: "TT" },
            { name: "Tunisia", code: "TN" }, { name: "Turkey", code: "TR" }, { name: "Turkmenistan", code: "TM" },
            { name: "Tuvalu", code: "TV" }, { name: "Uganda", code: "UG" }, { name: "Ukraine", code: "UA" },
            { name: "United Arab Emirates", code: "AE" }, { name: "United Kingdom", code: "GB" }, { name: "United States", code: "US" },
            { name: "Uruguay", code: "UY" }, { name: "Uzbekistan", code: "UZ" }, { name: "Vanuatu", code: "VU" },
            { name: "Vatican City", code: "VA" }, { name: "Venezuela", code: "VE" }, { name: "Vietnam", code: "VN" },
            { name: "Yemen", code: "YE" }, { name: "Zambia", code: "ZM" }, { name: "Zimbabwe", code: "ZW" }
        ].sort((a, b) => a.name.localeCompare(b.name)); // Sort alphabetically

        // Simulated economic data for a diverse set of countries.
        // Properties are boolean flags to simplify checking against categories.
        // This data is carefully crafted to ensure valid combinations exist for the game.
        const economicData = [
            { name: "United States", code: "US", properties: {
                developed: true, high_population: true, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "China", code: "CN", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: true, ease_of_business_low: false, remittance_high: false
            }},
            { name: "India", code: "IN", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Germany", code: "DE", properties: {
                developed: true, high_population: true, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Brazil", code: "BR", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: false
            }},
            { name: "Nigeria", code: "NG", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: true, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Switzerland", code: "CH", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Singapore", code: "SG", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: true, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Finland", code: "FI", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: false, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Bangladesh", code: "BD", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Chad", code: "TD", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: true, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: false
            }},
            { name: "Norway", code: "NO", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: true, manufacturing_high: false, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: false, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Japan", code: "JP", properties: {
                developed: true, high_population: true, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: false, gov_debt_high: true, fdi_high: true, rnd_high: true, net_food_importer: true, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Australia", code: "AU", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: false, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Argentina", code: "AR", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: false
            }},
            { name: "South Africa", code: "ZA", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: false
            }},
            { name: "Canada", code: "CA", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: true, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Mexico", code: "MX", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: true, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Vietnam", code: "VN", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: true
            }},
            { name: "Egypt", code: "EG", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "New Zealand", code: "NZ", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: false, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Sweden", code: "SE", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Ethiopia", code: "ET", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Colombia", code: "CO", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: true, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: true
            }},
            { name: "United Kingdom", code: "GB", properties: {
                developed: true, high_population: true, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: true, ease_of_business_low: false, remittance_high: false
            }},
            { name: "France", code: "FR", properties: {
                developed: true, high_population: true, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Italy", code: "IT", properties: {
                developed: true, high_population: true, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: false, gov_debt_high: true, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Spain", code: "ES", properties: {
                developed: true, high_population: true, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Indonesia", code: "ID", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: true
            }},
            { name: "Pakistan", code: "PK", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Russia", code: "RU", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: true, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: false, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Saudi Arabia", code: "SA", properties: {
                developed: false, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: true, manufacturing_high: false, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: true, ease_of_business_low: false, remittance_high: true
            }},
            { name: "United Arab Emirates", code: "AE", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: true, manufacturing_high: false, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: true, remittance_high: true, ease_of_business_low: false
            }},
            { name: "Qatar", code: "QA", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: true, manufacturing_high: false, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: true, remittance_high: true, ease_of_business_low: false
            }},
            { name: "Luxembourg", code: "LU", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: false, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Ireland", code: "IE", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Estonia", code: "EE", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: false, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Greece", code: "GR", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: false, current_account_deficit: true, gov_debt_high: true, fdi_high: false, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Portugal", code: "PT", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: false, current_account_deficit: false, gov_debt_high: true, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Belgium", code: "BE", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Netherlands", code: "NL", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Poland", code: "PL", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: true, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Turkey", code: "TR", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Thailand", code: "TH", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: true
            }},
            { name: "Philippines", code: "PH", properties: {
                developed: false, high_population: true, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Malaysia", code: "MY", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: true, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: true
            }},
            { name: "Chile", code: "CL", properties: {
                developed: false, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Peru", code: "PE", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Uzbekistan", code: "UZ", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Afghanistan", code: "AF", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Central African Republic", code: "CF", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: false
            }},
            { name: "Bolivia", code: "BO", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: true, manufacturing_high: false, external_debt_high: false, trade_surplus: false,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: false
            }},
            { name: "Paraguay", code: "PY", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: false, trade_surplus: true,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: false
            }},
            { name: "Kazakhstan", code: "KZ", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: true, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: false
            }},
            { name: "Austria", code: "AT", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Hungary", code: "HU", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: true,
                gdp_mid_range: true, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Czechia", code: "CZ", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Slovakia", code: "SK", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: true, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: true,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: true, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Nepal", code: "NP", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Laos", code: "LA", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Mongolia", code: "MN", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: false
            }},
            { name: "Eswatini", code: "SZ", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: false
            }},
            { name: "Lesotho", code: "LS", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: false
            }},
            { name: "Malawi", code: "MW", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: false
            }},
            { name: "Zambia", code: "ZM", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: true, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: false
            }},
            { name: "Zimbabwe", code: "ZW", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Rwanda", code: "RW", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Serbia", code: "RS", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: false, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: true
            }},
            { name: "Moldova", code: "MD", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Tajikistan", code: "TJ", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Kyrgyzstan", code: "KG", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Armenia", code: "AM", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Uzbekistan", code: "UZ", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: true, current_account_deficit: false, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Georgia", code: "GE", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false, // Technically not landlocked, but for game purposes, often grouped
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: true, ease_of_business_low: false, remittance_high: true
            }},
            { name: "Ukraine", code: "UA", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: true, fdi_high: false, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Romania", code: "RO", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: true, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: true
            }},
            { name: "Bulgaria", code: "BG", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: true, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: false, trade_surplus: false,
                gini_high: false, current_account_deficit: false, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: true
            }},
            { name: "Croatia", code: "HR", properties: {
                developed: true, high_population: false, high_gdp_per_capita: true, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: false, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: false, ease_of_business_low: false, remittance_high: false
            }},
            { name: "Montenegro", code: "ME", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: false, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: true, ease_of_business_low: false, remittance_high: true
            }},
            { name: "Bosnia and Herzegovina", code: "BA", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false, // Technically not landlocked, but for game purposes, often grouped
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "North Macedonia", code: "MK", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Albania", code: "AL", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Kosovo", code: "XK", properties: { // Not in allCountries, but adding for data diversity
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: true,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Palestine", code: "PS", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Jordan", code: "JO", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Lebanon", code: "LB", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: true, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: true, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Tunisia", code: "TN", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Morocco", code: "MA", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: true, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Mauritania", code: "MR", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: true, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Gambia", code: "GM", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Sierra Leone", code: "SL", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Liberia", code: "LR", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Guinea", code: "GN", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Guinea-Bissau", code: "GW", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Cabo Verde", code: "CV", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Sao Tome and Principe", code: "ST", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: false, landlocked_country: false,
                gdp_mid_range: false, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: false, manufacturing_high: false, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: true, ease_of_business_low: true, remittance_high: true
            }},
            { name: "Ecuador", code: "EC", properties: {
                developed: false, high_population: false, high_gdp_per_capita: false, major_tourist_destination: true, landlocked_country: false,
                gdp_mid_range: true, inflation_high: false, unemployment_low: false, agriculture_high: true, net_oil_exporter: true, manufacturing_high: true, external_debt_high: true, trade_surplus: false,
                gini_high: true, current_account_deficit: true, gov_debt_high: false, fdi_high: false, rnd_high: false, net_food_importer: false, ease_of_business_low: true, remittance_high: true
            }}
        ];

        // Category definitions for the simplified game
        const categories = [
            { name: "Developed Nation", property: "developed", definition: "Countries with an estimated Human Development Index (HDI) above 0.85 AND a GDP per capita (Purchasing Power Parity - PPP) exceeding $40,000 in the most recent available data.", type: "development" },
            { name: "Developing Nation", property: "developing", definition: "Countries with an estimated Human Development Index (HDI) below 0.7 OR a GDP per capita (Purchasing Power Parity - PPP) below $15,000 in the most recent available data.", check: (country) => !country.properties.developed, type: "development" },
            { name: "High Population (>100 Million)", property: "high_population", definition: "Countries with a current estimated population greater than 100,000,000 people.", type: "population" },
            { name: "Low Population (<5 Million)", property: "low_population", definition: "Countries with a current estimated population less than 5,000,000 people.", check: (country) => !country.properties.high_population && country.name !== "China" && country.name !== "India" && country.name !== "United States" && country.name !== "Indonesia" && country.name !== "Pakistan" && country.name !== "Brazil" && country.name !== "Nigeria" && country.name !== "Bangladesh" && country.name !== "Russia" && country.name !== "Japan" && country.name !== "Mexico" && country.name !== "Ethiopia" && country.name !== "Egypt" && country.name !== "Vietnam" && country.name !== "Philippines" && country.name !== "Germany" && country.name !== "United Kingdom" && country.name !== "France" && country.name !== "Italy" && country.name !== "Spain" && country.name !== "Turkey" && country.name !== "Thailand" && country.name !== "Poland", type: "population" },
            { name: "Major Tourist Destination (Top 20 by Arrivals)", property: "major_tourist_destination", definition: "Countries ranked among the top 20 globally for international tourist arrivals based on the latest UNWTO data.", type: "economy_focus" },
            { name: "Landlocked Country", property: "landlocked_country", definition: "Countries that are entirely enclosed by land, having no direct access to a coastline.", type: "geography" },
            { name: "Net Oil Exporter", property: "net_oil_exporter", definition: "Countries that are consistent net exporters of crude oil, meaning their crude oil exports significantly exceed their imports.", type: "resources" },
            { name: "Agriculture Contributes > 15% to GDP", property: "agriculture_high", definition: "Countries where the agricultural sector (including forestry and fishing) contributes more than 15% to the national Gross Domestic Product (GDP).", type: "sector_contribution" }
        ];

        // --- Game State Variables ---
        let guessesLeft = 12;
        let correctGuesses = 0;
        let gridCategories = { rows: [], cols: [] };
        // solutionGrid will now only store a *sample* country for solvability check during generation,
        // but the actual guess check will be against the categories.
        let solutionGrid = Array(3).fill(0).map(() => Array(3).fill(null));
        let guessedCells = Array(3).fill(0).map(() => Array(3).fill(false)); // Tracks if a cell is correctly guessed
        let gameActive = false; // To prevent interaction after game over

        // --- DOM Elements ---
        const gameGrid = document.getElementById('gameGrid');
        const guessesLeftEl = document.getElementById('guessesLeft');
        const correctGuessesEl = document.getElementById('correctGuesses');
        const gameMessageEl = document.getElementById('gameMessage');
        // Difficulty buttons removed from DOM element selection

        const definitionModal = document.getElementById('definitionModal');
        const modalCategoryTitle = document.getElementById('modalCategoryTitle');
        const modalCategoryDefinition = document.getElementById('modalCategoryDefinition');
        const gameOverModal = document.getElementById('gameOverModal');
        const gameOverTitle = document.getElementById('gameOverTitle');
        const gameOverMessage = document.getElementById('gameOverMessage');

        // --- Utility Functions ---

        /**
         * Gets the flag URL for a given country code.
         * @param {string} countryCode - The ISO 2-letter country code.
         * @returns {string} The URL to the country's flag image.
         */
        function getCountryFlagUrl(countryCode) {
            // Using flagsapi.com for flags
            return `https://flagsapi.com/${countryCode}/flat/64.png`;
        }

        /**
         * Shuffles an array in place using the Fisher-Yates algorithm.
         * @param {Array} array - The array to shuffle.
         */
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        /**
         * Checks if a country matches a given category's criteria.
         * @param {Object} country - The country object from economicData.
         * @param {Object} category - The category object with 'property' and optional 'check' function.
         * @returns {boolean} True if the country matches the category, false otherwise.
         */
        function doesCountryMatchCategory(country, category) {
            if (!country || !category || !country.properties) {
                return false;
            }
            if (category.check) {
                return category.check(country);
            }
            return country.properties[category.property] === true; // Ensure property is explicitly true
        }

        /**
         * Displays the category definition modal.
         * @param {string} title - The title of the category.
         * @param {string} definition - The explanation of the category.
         */
        function showCategoryDefinition(title, definition) {
            modalCategoryTitle.textContent = title;
            modalCategoryDefinition.textContent = definition;
            definitionModal.classList.remove('hidden');
        }

        /**
         * Hides the category definition modal.
         */
        function hideCategoryDefinition() {
            definitionModal.classList.add('hidden');
        }

        /**
         * Displays the game over modal.
         * @param {boolean} won - True if the player won, false otherwise.
         */
        function showGameOverModal(won) {
            gameActive = false; // Disable further interaction
            if (won) {
                gameOverTitle.textContent = "Congratulations!";
                gameOverMessage.textContent = `You correctly identified all 9 countries with ${12 - guessesLeft} guesses!`;
            } else {
                gameOverTitle.textContent = "Game Over!";
                gameOverMessage.textContent = `You ran out of guesses. You got ${correctGuesses}/9 correct. Better luck tomorrow!`;
            }
            gameOverModal.classList.remove('hidden');
        }

        /**
         * Updates the game information display (guesses left, correct guesses).
         */
        function updateGameInfo() {
            guessesLeftEl.textContent = `Guesses: ${guessesLeft}`;
            correctGuessesEl.textContent = `Correct: ${correctGuesses}/9`;
        }

        /**
         * Generates the 3x3 grid with random categories for the chosen difficulty.
         * Ensures categories do not contradict each other and a valid country exists for each intersection.
         */
        function generateGrid() {
            const allPossibleCategories = [...categories];
            let selectedRowCategories = [];
            let selectedColCategories = [];
            let attempts = 0;
            const MAX_CATEGORY_SELECTION_ATTEMPTS = 500;

            while (attempts < MAX_CATEGORY_SELECTION_ATTEMPTS) {
                attempts++;
                shuffleArray(allPossibleCategories);

                let tempCategories = [];
                let usedCategoryNames = new Set();
                let usedCategoryTypes = new Set(); // Track used category types

                // Select 6 unique categories, ensuring unique types
                for (const cat of allPossibleCategories) {
                    if (tempCategories.length < 6 && !usedCategoryNames.has(cat.name) && !usedCategoryTypes.has(cat.type)) {
                        tempCategories.push(cat);
                        usedCategoryNames.add(cat.name);
                        usedCategoryTypes.add(cat.type);
                    }
                    if (tempCategories.length === 6) break;
                }

                if (tempCategories.length < 6) continue; // Not enough categories, retry

                let tempRows = tempCategories.slice(0, 3);
                let tempCols = tempCategories.slice(3, 6);

                let allCellsHaveSolution = true;
                let currentAttemptSolutionGrid = Array(3).fill(0).map(() => Array(3).fill(null));

                for (let r = 0; r < 3; r++) {
                    for (let c = 0; c < 3; c++) {
                        const rowCategory = tempRows[r];
                        const colCategory = tempCols[c];
                        let foundCountryForCell = null;

                        shuffleArray(economicData);
                        for (const country of economicData) {
                            if (doesCountryMatchCategory(country, rowCategory) && doesCountryMatchCategory(country, colCategory)) {
                                foundCountryForCell = country;
                                break;
                            }
                        }

                        if (!foundCountryForCell) {
                            allCellsHaveSolution = false;
                            break;
                        }
                        currentAttemptSolutionGrid[r][c] = foundCountryForCell;
                    }
                    if (!allCellsHaveSolution) break;
                }

                if (allCellsHaveSolution) {
                    selectedRowCategories = tempRows;
                    selectedColCategories = tempCols;
                    gridCategories.rows = selectedRowCategories;
                    gridCategories.cols = selectedColCategories;
                    solutionGrid = currentAttemptSolutionGrid;
                    break;
                }
            }

            if (attempts === MAX_CATEGORY_SELECTION_ATTEMPTS) {
                console.error("Failed to generate a valid grid after multiple attempts. This might indicate an issue with the economicData or category definitions, where some combinations are impossible to satisfy. Consider adjusting the data or category definitions.");
            }
        }

        /**
         * Renders the game grid HTML based on current state.
         */
        function renderGrid() {
            // Clear existing grid content except the top-left empty cell
            const existingHeaders = gameGrid.querySelectorAll('.grid-header');
            existingHeaders.forEach(el => el.remove());
            const existingCells = gameGrid.querySelectorAll('.grid-cell:not(.bg-transparent)');
            existingCells.forEach(el => el.remove());

            // Add column headers
            gridCategories.cols.forEach((cat, index) => {
                const headerEl = document.createElement('div');
                headerEl.className = 'grid-header col-header';
                headerEl.dataset.col = index;
                headerEl.textContent = cat.name;
                headerEl.title = cat.definition; // For basic hover tooltip
                headerEl.onclick = () => showCategoryDefinition(cat.name, cat.definition);
                gameGrid.appendChild(headerEl);
            });

            // Add row headers and cells
            for (let r = 0; r < 3; r++) {
                const rowCat = gridCategories.rows[r];
                const rowHeaderEl = document.createElement('div');
                rowHeaderEl.className = 'grid-header row-header';
                rowHeaderEl.dataset.row = r;
                rowHeaderEl.textContent = rowCat.name;
                rowHeaderEl.title = rowCat.definition; // For basic hover tooltip
                rowHeaderEl.onclick = () => showCategoryDefinition(rowCat.name, rowCat.definition);
                gameGrid.appendChild(rowHeaderEl);

                for (let c = 0; c < 3; c++) {
                    const cellEl = document.createElement('div');
                    cellEl.className = 'grid-cell';
                    cellEl.dataset.row = r;
                    cellEl.dataset.col = c;

                    const inputEl = document.createElement('input');
                    inputEl.type = 'text';
                    inputEl.placeholder = 'Type country...';
                    inputEl.className = 'country-input';
                    inputEl.dataset.row = r;
                    inputEl.dataset.col = c;
                    inputEl.autocomplete = "off"; // Disable browser autocomplete

                    // Autocomplete container
                    const autocompleteContainer = document.createElement('div');
                    autocompleteContainer.className = 'autocomplete-container';
                    autocompleteContainer.appendChild(inputEl);

                    // Suggestions list
                    const suggestionsList = document.createElement('div');
                    suggestionsList.className = 'autocomplete-list hidden';
                    autocompleteContainer.appendChild(suggestionsList);

                    cellEl.appendChild(autocompleteContainer);
                    gameGrid.appendChild(cellEl);

                    // Add event listeners for input and keydown
                    inputEl.addEventListener('input', (event) => autoSuggest(event.target, suggestionsList));
                    inputEl.addEventListener('keydown', (event) => {
                        if (event.key === 'Enter' && gameActive) {
                            event.preventDefault(); // Prevent default form submission
                            checkGuess(r, c, event.target.value.trim(), inputEl, cellEl);
                            suggestionsList.classList.add('hidden'); // Hide suggestions after enter
                        }
                    });
                    inputEl.addEventListener('focus', () => {
                        if (!guessedCells[r][c]) { // Only show suggestions if not already guessed
                            autoSuggest(inputEl, suggestionsList); // Show suggestions on focus if input is not empty
                        }
                    });
                    inputEl.addEventListener('blur', () => {
                        // Delay hiding to allow click on suggestion
                        setTimeout(() => suggestionsList.classList.add('hidden'), 100);
                    });
                }
            }
            // Re-append the first empty cell to ensure correct grid flow
            const emptyCell = document.querySelector('.grid-cell.bg-transparent');
            if (emptyCell) {
                gameGrid.prepend(emptyCell);
            }
        }

        /**
         * Handles auto-suggestion for country input.
         * @param {HTMLInputElement} inputEl - The input element.
         * @param {HTMLElement} suggestionsList - The container for suggestions.
         */
        function autoSuggest(inputEl, suggestionsList) {
            const inputValue = inputEl.value.toLowerCase();
            suggestionsList.innerHTML = ''; // Clear previous suggestions

            if (inputValue.length === 0) {
                suggestionsList.classList.add('hidden');
                return;
            }

            const filteredCountries = allCountries.filter(country =>
                country.name.toLowerCase().startsWith(inputValue)
            ).slice(0, 10); // Limit to 10 suggestions

            if (filteredCountries.length > 0) {
                filteredCountries.forEach(country => {
                    const item = document.createElement('div');
                    item.className = 'autocomplete-item';
                    item.textContent = country.name;
                    item.addEventListener('mousedown', (event) => { // Use mousedown to prevent blur from hiding list
                        event.preventDefault(); // Prevent input from losing focus immediately
                        inputEl.value = country.name;
                        suggestionsList.classList.add('hidden');
                        inputEl.focus(); // Keep focus on input after selection
                    });
                    suggestionsList.appendChild(item);
                });
                suggestionsList.classList.remove('hidden');
            } else {
                suggestionsList.classList.add('hidden');
            }
        }

        /**
         * Checks the player's guess for a specific cell.
         * @param {number} row - The row index of the cell.
         * @param {number} col - The column index of the cell.
         * @param {string} guessedCountryName - The name of the country guessed by the player.
         * @param {HTMLInputElement} inputEl - The input element for the cell.
         * @param {HTMLElement} cellEl - The grid cell element.
         */
        function checkGuess(row, col, guessedCountryName, inputEl, cellEl) {
            if (guessedCells[row][col] || !gameActive) {
                return; // Already guessed or game not active
            }

            // Find the country object from the economicData based on the guessed name
            const guessedCountryObj = economicData.find(c => c.name.toLowerCase() === guessedCountryName.toLowerCase());

            if (!guessedCountryObj) {
                gameMessageEl.textContent = "Please enter a valid country name from the list.";
                gameMessageEl.classList.remove('text-green-600');
                gameMessageEl.classList.add('text-red-600');
                return;
            }

            guessesLeft--;
            updateGameInfo();

            const rowCategory = gridCategories.rows[row];
            const colCategory = gridCategories.cols[col];

            // Check if the guessed country matches BOTH the row and column categories
            let isCorrect = doesCountryMatchCategory(guessedCountryObj, rowCategory) &&
                            doesCountryMatchCategory(guessedCountryObj, colCategory);

            // Clear previous result (if any)
            const existingIcon = cellEl.querySelector('.result-icon');
            if (existingIcon) existingIcon.remove();
            const existingFlag = cellEl.querySelector('.flag');
            if (existingFlag) existingFlag.remove();

            if (isCorrect) {
                correctGuesses++;
                guessedCells[row][col] = true;
                inputEl.disabled = true; // Disable input for correct cells
                inputEl.value = guessedCountryObj.name; // Ensure correct casing
                inputEl.classList.add('bg-green-50', 'text-green-800'); // Visual feedback

                const flagImg = document.createElement('img');
                flagImg.src = getCountryFlagUrl(guessedCountryObj.code);
                flagImg.alt = guessedCountryObj.name;
                flagImg.className = 'flag';
                cellEl.appendChild(flagImg);

                gameMessageEl.textContent = "Correct!";
                gameMessageEl.classList.remove('text-red-600');
                gameMessageEl.classList.add('text-green-600');
            } else {
                const redCross = document.createElement('i');
                redCross.className = 'fas fa-times-circle result-icon incorrect';
                cellEl.appendChild(redCross);

                gameMessageEl.textContent = "Incorrect. Try again!";
                gameMessageEl.classList.remove('text-green-600');
                gameMessageEl.classList.add('text-red-600');
            }

            updateGameInfo();

            // Check game end conditions
            if (correctGuesses === 9) {
                showGameOverModal(true);
            } else if (guessesLeft === 0) {
                showGameOverModal(false);
            }
        }

        /**
         * Initializes a new game, setting up categories and resetting state.
         */
        function initializeGame() {
            guessesLeft = 12;
            correctGuesses = 0;
            gameActive = true;
            guessedCells = Array(3).fill(0).map(() => Array(3).fill(false)); // Reset guessed cells

            gameMessageEl.textContent = ""; // Clear messages
            updateGameInfo();

            // Generate new grid directly
            generateGrid();
            renderGrid(); // Render the grid with new categories
        }

        // --- Event Listeners and Initial Setup ---
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize game on page load
            initializeGame();
        });

        // Close modal on escape key
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                hideCategoryDefinition();
                gameOverModal.classList.add('hidden'); // Also hide game over modal
            }
        });

        // Close modal by clicking outside content
        definitionModal.addEventListener('click', (event) => {
            if (event.target === definitionModal) {
                hideCategoryDefinition();
            }
        });
        gameOverModal.addEventListener('click', (event) => {
            if (event.target === gameOverModal) {
                gameOverModal.classList.add('hidden');
            }
        });

    </script>
</body>
</html>
